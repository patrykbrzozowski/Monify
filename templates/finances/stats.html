{% extends 'base.html' %}
{% load static %}



{% block content %}
<div class="container"
    x-data="alpineInstance()"
    x-init="fetch('/finances/get_statistics_data')
            .then(response => response.json())
            .then(data => stats_data = data)"
  >
    <h1 class="text-3xl my-7 mx-10">Statystyki</h1>

    <div class="text-gray-600 my-14 w-full">
      <div class="grid md:grid-cols-4 gap-8 md:mx-5">
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-2xl font-bold">Rok (Å›red.)</h1>
          <div class="grid md:grid-cols-2 my-3">
            <div class="">
              <!-- <h1 class="text-2xl my-2">Wydatki</h1> -->
              <p class="text-xl text-red-500" x-text="'- ' + stats_data.average_outcomes_per_year + ' ' + stats_data.user_currency"></p>
            </div>
            <div class="">
              <!-- <h1 class="text-2xl my-2">Przychody</h1> -->
              <p class="text-xl text-green-500" x-text="stats_data.average_incomes_per_year + ' ' + stats_data.user_currency"></p>
            </div>
          </div>
        </div>
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-2xl font-bold">MiesiÄ…c (Å›red.)</h1>
          <div class="grid md:grid-cols-2 my-3">
            <div class="">
              <!-- <h1 class="text-2xl my-2">Wydatki</h1> -->
              <p class="text-xl text-red-500" x-text="'- ' + stats_data.average_outcomes_per_month + ' ' + stats_data.user_currency"></p>
            </div>
            <div class="">
              <!-- <h1 class="text-2xl my-2">Przychody</h1> -->
              <p class="text-xl text-green-500" x-text="stats_data.average_incomes_per_month + ' ' + stats_data.user_currency"></p>
            </div>
          </div>
        </div>
        
      </div>
    </div>

    <div class="text-gray-600 my-14 w-full">
      <div class="grid md:grid-cols-4 gap-8 md:mx-5">
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-2xl font-bold">DzieÅ„ (Å›red.)</h1>
          <div class="grid md:grid-cols-2 my-3">
            <div class="">
              <!-- <h1 class="text-2xl my-2">Wydatki</h1> -->
              <p class="text-xl text-red-500" x-text="'- ' + stats_data.average_outcomes_per_day + ' ' + stats_data.user_currency"></p>
            </div>
            <div class="">
              <!-- <h1 class="text-2xl my-2">Przychody</h1> -->
              <p class="text-xl text-green-500" x-text="stats_data.average_incomes_per_day + ' ' + stats_data.user_currency"></p>
            </div>
          </div>
          <!-- <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p> -->
          <!-- <template x-if="stats_data.years_difference > 0">
            <p class="text-lg text-green-500" x-text="stats_data.average_incomes_per_year + ' ' + stats_data.user_currency"></p>
          </template> -->
          <!-- <template x-if="stats_data.years_difference == 0">
            <p class="text-sm">Za maÅ‚o danych, musisz korzystaÄ‡ ponad rok, aby zobaczyÄ‡ te dane...</p>
          </template> -->
          <!-- <template x-if="stats_data.data_exist === false">
            <p class="text-sm" x-text="stats_data.income_information"></p>
          </template> -->
          <!-- <p class="text-sm">100 zÅ‚</p> -->
        </div>
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-2xl font-bold">TydzieÅ„ (Å›red.)</h1>
          <div class="grid md:grid-cols-2 my-3">
            <div class="">
              <!-- <h1 class="text-2xl my-2">Wydatki</h1> -->
              <p class="text-xl text-red-500" x-text="'- ' + stats_data.average_outcomes_per_week + ' ' + stats_data.user_currency"></p>
            </div>
            <div class="">
              <!-- <h1 class="text-2xl my-2">Przychody</h1> -->
              <p class="text-xl text-green-500" x-text="stats_data.average_incomes_per_week + ' ' + stats_data.user_currency"></p>
            </div>
          </div>
        </div>
        
      </div>
    </div>
    <!-- <div
      class="bg-purple-600 text-white shadow-xl border border-purple-700 my-10 mx-10 rounded-xl md:w-11/12"
    >
      <div class="p-10 mx-auto my-auto lg:grid lg:grid-cols-2 gap-1">
        <div class="">
          <h1 class="mx-auto mb-6 text-4xl">Aktualny stan konta:</h1>
          <p class="mx-auto text-3xl mb-2"
            x-text="stats_data.total_balance + ' zÅ‚'">0000,00 zÅ‚</p>
          <p class="mx-auto text-md">Wszystkie konta</p>
        </div>
        <div class="hidden 2xl:block">
          <i
            class="ml-80 fa-solid fa-credit-card text-9xl text-purple-700"
          ></i>
        </div>
      </div>
    </div> -->
    <!-- <div class="text-gray-600 grid grid-rows-1 my-14">
      <div class="grid md:grid-cols-4 gap-5 xl:gap-8 xl:mx-5">
        <div
          class="mx-auto border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Przychody:</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <p class="text-lg text-green-500" x-text="stats_data.total_income + ' zÅ‚'"></p>
        </div>
        <div
          class="mx-auto border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Wydatki</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <p class="text-lg text-red-500" x-text="'- ' + stats_data.total_outcome + ' zÅ‚'"></p>
        </div>
        <div
          class="mx-auto border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">OszczÄ™dnoÅ›ci:</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <p class="text-lg " >
            <span x-text="stats_data.savings + ' zÅ‚'"></span>
            <span>ðŸ”¥</span>
          </p>
        </div>
        <div
          class="mx-auto border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Przychody</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <p class="text-lg">1000 zÅ‚</p>
        </div>
      </div>
    </div> -->
    <!-- <div class="text-gray-600 grid grid-rows-1 my-14">
      <div class="grid md:grid-cols-4 gap-8 md:mx-5">
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Ostatnie przychody:</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <template x-for="income in stats_data.last_five_incomes" :key="income.id">
            <div class="grid grid-cols-3 my-3 gap-4">
              <p x-text="income.type"></p>
              <p class="text-gray-400" x-text="income.date">20.12.222</p>
              <p class="text-green-500" x-text="income.value + ' zÅ‚'">3000 zÅ‚</p>
            </div>
          </template>
        </div>
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Ostatnie wydatki:</h1>
          <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p>
          <template x-for="outcome in stats_data.last_five_outcomes" :key="outcome.id">
            <div class="grid grid-cols-3 my-3 gap-4">
              <p x-text="outcome.type"></p>
              <p class="text-gray-400" x-text="outcome.date">20.12.222</p>
              <p class="text-red-500" x-text="'- ' + outcome.value + ' zÅ‚'">- 60 zÅ‚</p>

            </div>
          </template>
        </div>
      </div>
    </div> -->



    <div class="text-gray-600 my-14 md:w-full w-3/6">
      <div class="grid md:grid-cols-4 gap-8 md:mx-5">
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >

        <div class="grid grid-rows-1">
          <div>
            <h1 class="text-lg font-bold mb-4">Przychody wg. kategorii</h1>
            <!-- <select id="countries" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
              <option selected>Choose a country</option>
              <option value="US">United States</option>
              <option value="CA">Canada</option>
              <option value="FR">France</option>
              <option value="DE">Germany</option>
            </select> -->

            <select class="uppercase bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="chart-time-type-income">
              <option value="week">tydzieÅ„</option>
              <option value="mon1">miesiÄ…c</option>
              <option value="mon3">3 miesiÄ…ce</option>
              <option value="mon6">6 miesiÄ™cy</option>
              <option value="year1" selected>bieÅ¼Ä…cy rok</option>
              <option value="all">Wszystko</option>
            </select>
            <select class="uppercase bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="chart-view-type-income">
              <option value="amount" selected>kwota</option>
              <option value="percentage">procentowo</option>
            </select>
          </div>



        </div>
        <!-- <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p> -->
        <div class="card-body flex">
          <div class="chart-area w-full">
              <canvas class="" id="income_by_type"></canvas>
          </div>
        </div>
 
        </div>
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >

        <div class="grid grid-rows-1">
          <div>
            <h1 class="text-lg font-bold mb-4">Wydatki wg. kategorii</h1>
            <!-- <select id="countries" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
              <option selected>Choose a country</option>
              <option value="US">United States</option>
              <option value="CA">Canada</option>
              <option value="FR">France</option>
              <option value="DE">Germany</option>
            </select> -->

            <select class="uppercase bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="chart-time-type-outcome">
              <option value="week">tydzieÅ„</option>
              <option value="mon1">miesiÄ…c</option>
              <option value="mon3">3 miesiÄ…ce</option>
              <option value="mon6">6 miesiÄ™cy</option>
              <option value="year1" selected>bieÅ¼Ä…cy rok</option>
              <option value="all">Wszystko</option>
            </select>
            <select class="uppercase bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="chart-view-type-outcome">
              <option value="amount" selected>kwota</option>
              <option value="percentage">procentowo</option>
            </select>
          </div>



        </div>
        <!-- <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p> -->
        <div class="card-body flex">
          <div class="chart-area w-full">
              <canvas class="" id="outcome_by_type"></canvas>
          </div>
        </div>
 
        </div>
      </div>
    </div>

    <div class="text-gray-600 grid grid-rows-1 my-14">
      <div class="grid md:grid-cols-4 gap-8 md:mx-5">
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >

        <div class="grid grid-rows-1">
          <div>
            <h1 class="text-lg font-bold mb-4">Przychody</h1>
            <!-- <select id="countries" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
              <option selected>Choose a country</option>
              <option value="US">United States</option>
              <option value="CA">Canada</option>
              <option value="FR">France</option>
              <option value="DE">Germany</option>
            </select> -->

            <select class="uppercase mb-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="bar-chart-time-type-income">
              <option value="week">tydzieÅ„</option>
              <option value="mon1">miesiÄ…c</option>
              <option value="mon3">3 miesiÄ…ce</option>
              <option value="mon6">6 miesiÄ™cy</option>
              <option value="year1" selected>bieÅ¼Ä…cy rok</option>
            </select>
          </div>



        </div>
        <!-- <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p> -->
        <div class="card-body flex">
          <div class="chart-area w-full">
              <canvas class="" id="income_bar_chart"></canvas>
          </div>
        </div>
 
        </div>
        <div
          class="col-span-2 mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >

        <div class="grid grid-rows-1">
          <div>
            <h1 class="text-lg font-bold mb-4">Wydatki</h1>
            <!-- <select id="countries" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
              <option selected>Choose a country</option>
              <option value="US">United States</option>
              <option value="CA">Canada</option>
              <option value="FR">France</option>
              <option value="DE">Germany</option>
            </select> -->

            <select class="uppercase mb-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="bar-chart-time-type-outcome">
              <option value="week">tydzieÅ„</option>
              <option value="mon1">miesiÄ…c</option>
              <option value="mon3">3 miesiÄ…ce</option>
              <option value="mon6">6 miesiÄ™cy</option>
              <option value="year1" selected>bieÅ¼Ä…cy rok</option>
            </select>
          </div>



        </div>
        <!-- <p class="text-xs mb-3" x-text="'Od poczÄ…tku miesiÄ…ca ' + '(' + stats_data.actual_month + ')'"></p> -->
        <div class="card-body flex">
          <div class="chart-area w-full">
              <canvas class="" id="outcome_bar_chart"></canvas>
          </div>
        </div>
 
        </div>
      </div>
    </div>

    <div class="text-gray-600 grid grid-rows-1 my-14">
      <div class=" md:mx-5">
        <div
          class="mx-8 border border-gray-700 border-b-purple-700 border-b-4 shadow-lg p-8 rounded-lg"
        >
          <h1 class="text-lg font-bold">Wykres przychody kontra wydatki</h1>
          <select class="uppercase my-3 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5" id="bar-chart-time-type-outcome">
            <option value="week">tydzieÅ„</option>
            <option value="mon1">miesiÄ…c</option>
            <option value="mon3">3 miesiÄ…ce</option>
            <option value="mon6">6 miesiÄ™cy</option>
            <option value="year1" selected>bieÅ¼Ä…cy rok</option>
          </select>
          <div>
            <template x-for="income in stats_data.last_five_outcomes">
              <div class="grid grid-cols-1 my-3 gap-4">
                <!-- <p x-text="income.type"></p>
                <p class="text-gray-400" x-text="income.value">20.12.222</p> -->
                <!-- <p class="text-green-500" x-text="income.progress + ' zÅ‚'">3000 zÅ‚</p> -->
                <p>Lola</p>
                <!-- <div class="w-full bg-gray-200 rounded-full dark:bg-gray-700">
                  <div class="bg-blue-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full" style="width: 45%;" x-text="income.progress" id="progressbar"> 45%</div>
                </div> -->
              </div>
            </template>
          </div>
          <!-- <div class="card-body">
            <div class="chart-area">
                <canvas height="100vh" id="year_chart_canvas"></canvas>
            </div>
        </div> -->
        </div>
      </div>
    </div>

    <!-- <div class="row d-none d-md-block" id="year_chart">
      <div class="col-12">
          <div class="card shadow mb-4">
              <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                  <h6 class="m-0 font-weight-bold text-primary">Current Balance over Year</h6>
                  <div class="dropdown no-arrow">
                      <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                         data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                      </a>
                      <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                           aria-labelledby="dropdownMenuLink">
                          <div class="dropdown-header">Dropdown Header:</div>
                          <a class="dropdown-item" href="#">Action</a>
                          <a class="dropdown-item" href="#">Another action</a>
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#">Something else here</a>
                      </div>
                  </div>
              </div>
              <div class="card-body">
                  <div class="chart-area">
                      <canvas id="year_chart_canvas"></canvas>
                  </div>
              </div>
          </div>
      </div>
  </div> -->
  </div>
{% endblock %}

{% block js %}

<script src="{% static 'vendor/chart.js/Chart.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"
        integrity="sha512-Wt1bJGtlnMtGP0dqNFH1xlkLBNpEodaiQ8ZN5JLA5wpc1sUlk/O5uuOMNgvzddzkpvZ9GLyYNa8w2s7rqiTk5Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="{% static 'js/common_charts.js' %}"></script>
<script src="{% static 'js/year_overview_charts.js' %}"></script>

<script>
    const $greeting = $('#greeting');
    const hour = new Date().getHours();

    if (hour < 18) $greeting.text('DzieÅ„ dobry');
    else $greeting.text('Dobry wieczÃ³r');
    
  function alpineInstance() {
    return {
      stats_data: []
    };
}
</script>

<script>

$(document).ready(function() {
  
  // // let goalContainer = document.getElementById("goal");

  // let loadChart = function(summary_type) {
  //   // ?get_what=income&summary_type=year_overview
  //   $.get(`/finances/get_income_or_outcome_by_type?get_what=outcome&summary_type=${summary_type}`, function (res) {
  //     // console.log(res.goal)
  //     // goalContainer.innerHTML = res.goal[0];
  //       let canvas = document.getElementById('myChart');
  //       const config = {
  //       type: 'doughnut',
  //       data: {
  //           labels: res.labels,
  //           datasets: [
  //               {
  //                   data: res.data,
  //                   backgroundColor: [
  //                       'rgb(255, 99, 132)',
  //                       'rgb(255, 159, 64)',
  //                       'rgb(255, 205, 86)',
  //                       'rgb(75, 192, 192)',
  //                       'rgb(54, 162, 235)',
  //                       'rgb(153, 102, 255)',
  //                       'rgb(201, 203, 207)',
  //                       'rgb(255, 205, 86)',
  //                       // 'rgb(255, 150, 60)',
  //                       'rgb(179, 136, 235)',
  //                       'rgb(247, 174, 248)',
  //                       'rgb(128, 147, 241)',
  //                       'rgb(114, 221, 247)',
  //                       'rgb(253, 197, 245)',
  //                       'rgb(116, 198, 157)',
  //                       'rgb(247, 37, 133)',
  //                       'rgb(156, 102, 68)',
  //                       'rgb(221, 184, 146)',
  //                       'rgb(27, 38, 59)',
  //                       'rgb(90, 24, 154)',
  //                       // '#f60a0a',
  //                       // '#2019c0',
  //                       // '#a81b1b',
  //                       // '#000000',
  //                       // '#ffd200',
  //                       // '#468650',
  //                       // '#f6a900',
  //                       // '#3c73d3',
  //                       // '#cf3535',
  //                       // '#ecc615',
  //                       // '#c82727',
  //                       // '#071260',
  //                   ],
  //                   hoverOffset: 4,
  //               }
  //           ]
  //       },
  //       options: {
  //           plugins: {
  //               legend: {
  //                   display: false,
  //               },
  //           },
  //           maintainAspectRatio: false,
  //           layout: {
  //               padding: {
  //                   left: 5,
  //                   right: 5,
  //                   top: 5,
  //                   bottom: 5
  //               }
  //           },
            
  //       },
  //       responsive: true
  //   };
  //       var myChart = new Chart(canvas, config);
  //       myChart.destroy();
  //   });
  // }

  

  // loadChart('mon1')
  // $('#chart-time-type-outcome').on('change', function() {
  //     let summary_type = $('#chart-time-type-outcome').val()
  //     loadChart(summary_type)
  //   })
  
  // })
  // $(document).ready(function() {
    
  //   let goalContainer = document.getElementById("goal");

    let myChart_outcomes = null;
    let myChart_incomes = null;
    let myChart_bar_incomes = null;
    let myChart_bar_outcomes = null;

    const doughnut_chart_outcomes = (res, canvas_id, context_label) => {
    let canvas = $(`#${canvas_id}`)
    const config = {
        type: 'doughnut',
        data: {
            labels: res.labels,
            datasets: [
                {
                    data: res.data,
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(255, 159, 64)',
                        'rgb(255, 205, 86)',
                        'rgb(75, 192, 192)',
                        'rgb(54, 162, 235)',
                        'rgb(153, 102, 255)',
                        'rgb(201, 203, 207)',
                        'rgb(255, 205, 86)',
                        // 'rgb(255, 150, 60)',
                        'rgb(179, 136, 235)',
                        'rgb(247, 174, 248)',
                        'rgb(128, 147, 241)',
                        'rgb(114, 221, 247)',
                        'rgb(253, 197, 245)',
                        'rgb(116, 198, 157)',
                        'rgb(247, 37, 133)',
                        'rgb(156, 102, 68)',
                        'rgb(221, 184, 146)',
                        'rgb(27, 38, 59)',
                        'rgb(90, 24, 154)',
                        // '#f60a0a',
                        // '#2019c0',
                        // '#a81b1b',
                        // '#000000',
                        // '#ffd200',
                        // '#468650',
                        // '#21248a',
                        // '#ff7a00',
                        // '#dfdfdf',
                        // '#b60000',
                        // '#2f8ebc',
                        // '#011d92',
                        // '#dfdfdf',
                        // '#e0be1d',
                        // '#0b66aa',
                        // '#295934',
                        // '#2933d9',
                        // '#00d614',
                        // '#c30000',
                        // '#354dcb',
                        // '#762424',
                        // '#ffc000',
                        // '#6dc0f6',
                        // '#dfdfdf',
                        // '#a07900',
                        // '#ff6000',
                        // '#ff0000',
                        // '#ffbcbc',
                        // '#064a00',
                        // '#201b82',
                        // '#3d2269',
                        // '#294bff',
                        // '#ff3333',
                        // '#f6a900',
                        // '#3c73d3',
                        // '#cf3535',
                        // '#ecc615',
                        // '#c82727',
                        // '#071260',
                    ],
                    hoverOffset: 4,
                }
            ]
        },
        options: {
            plugins: {
                legend: {
                    display: false,
                },
                tooltip: {
                  callbacks: {
                    label: (context) => {
                      // console.log(context)
                      return ` ${context.label} - ${context.parsed} ${context_label}`
                    }
                  }
                },
            },
            layout: {
                padding: {
                    left: 5,
                    right: 5,
                    top: 5,
                    bottom: 5
                }
            },
            responsive: true,
            maintainAspectRatio: true
        },
        
    };


    if(myChart_outcomes!= null) {
        myChart_outcomes.destroy()
    }

      myChart_outcomes = new Chart(canvas, config);

}

const doughnut_chart_incomes = (res, canvas_id, context_label) => {
    let canvas = $(`#${canvas_id}`)
    const config = {
        type: 'doughnut',
        data: {
            labels: res.labels,
            datasets: [
                {
                    data: res.data,
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(255, 159, 64)',
                        'rgb(255, 205, 86)',
                        'rgb(75, 192, 192)',
                        'rgb(54, 162, 235)',
                        'rgb(153, 102, 255)',
                        'rgb(201, 203, 207)',
                        'rgb(255, 205, 86)',
                        // 'rgb(255, 150, 60)',
                        'rgb(179, 136, 235)',
                        'rgb(247, 174, 248)',
                        'rgb(128, 147, 241)',
                        'rgb(114, 221, 247)',
                        'rgb(253, 197, 245)',
                        'rgb(116, 198, 157)',
                        'rgb(247, 37, 133)',
                        'rgb(156, 102, 68)',
                        'rgb(221, 184, 146)',
                        'rgb(27, 38, 59)',
                        'rgb(90, 24, 154)',
                        // '#f60a0a',
                        // '#2019c0',
                        // '#a81b1b',
                        // '#000000',
                        // '#ffd200',
                        // '#468650',
                        // '#21248a',
                        // '#ff7a00',
                        // '#dfdfdf',
                        // '#b60000',
                        // '#2f8ebc',
                        // '#011d92',
                        // '#dfdfdf',
                        // '#e0be1d',
                        // '#0b66aa',
                        // '#295934',
                        // '#2933d9',
                        // '#00d614',
                        // '#c30000',
                        // '#354dcb',
                        // '#762424',
                        // '#ffc000',
                        // '#6dc0f6',
                        // '#dfdfdf',
                        // '#a07900',
                        // '#ff6000',
                        // '#ff0000',
                        // '#ffbcbc',
                        // '#064a00',
                        // '#201b82',
                        // '#3d2269',
                        // '#294bff',
                        // '#ff3333',
                        // '#f6a900',
                        // '#3c73d3',
                        // '#cf3535',
                        // '#ecc615',
                        // '#c82727',
                        // '#071260',
                    ],
                    hoverOffset: 4,
                }
            ]
        },
        options: {
            plugins: {
                legend: {
                    display: false,
                },
                tooltip: {
                  callbacks: {
                    label: (context) => {
                      // console.log(context)
                      return ` ${context.label} - ${context.parsed} ${context_label}`
                    }
                  }
                }
            },
            layout: {
                padding: {
                    left: 5,
                    right: 5,
                    top: 5,
                    bottom: 5
                }
            },
            responsive: true,
            maintainAspectRatio: true
        },
    };


    if(myChart_incomes!= null) {
        myChart_incomes.destroy()
    }

      myChart_incomes = new Chart(canvas, config);

}

const bar_chart_incomes = (res, canvas_id, context_label) => {
    let canvas = $(`#${canvas_id}`)
    const config = {
        type: 'bar',
        data: {
            labels: res.labels,
            datasets: [
                {
                    data: res.data,
                    backgroundColor: "#4ade80",
                    borderWidth: 2,
                    borderRadius: Number.MAX_VALUE,
                    borderSkipped: false,
                    hoverOffset: 4,
                }
            ]
        },
        options: {
            barValueSpacing: 20,
            scales:
        {
            y: {
                display: false,
                grid: {
                    drawBorder: false, // <-- this removes y-axis line
                    lineWidth: 0.5,
                }
            },
            x: {
                grid: {
                    drawBorder: false, // <-- this removes y-axis line
                    lineWidth: 0.5,
                }
            }
        },
            plugins: {
                legend: {
                    display: false,
                },
                tooltip: {
                  callbacks: {
                    label: (context) => {
                      // console.log(context)
                      return ` ${context.label} - ${context.raw} ${context_label}`
                    }
                  }
                }
            },
            layout: {
                padding: {
                    left: 5,
                    right: 5,
                    top: 5,
                    bottom: 5
                }
            },
            aspectRatio: 1,
            maintainAspectRatio: false
        },
    };


    if(myChart_bar_incomes!= null) {
        myChart_bar_incomes.destroy()
    }

      myChart_bar_incomes = new Chart(canvas, config);

}

const bar_chart_outcomes = (res, canvas_id, context_label) => {
    let canvas = $(`#${canvas_id}`)
    const config = {
        type: 'bar',
        data: {
            labels: res.labels,
            datasets: [
                {
                    data: res.data,
                    backgroundColor: "#f87171",
                    borderWidth: 2,
                    borderRadius: Number.MAX_VALUE,
                    borderSkipped: false,
                    hoverOffset: 4,
                }
            ]
        },
        options: {
          barValueSpacing: 20,
            scales:
        {
            y: {
                display: false,
                grid: {
                    drawBorder: false, // <-- this removes y-axis line
                    lineWidth: 0.5,
                }
            },
            x: {
                grid: {
                    drawBorder: false, // <-- this removes y-axis line
                    lineWidth: 0.5,
                }
            }
        },
            plugins: {
                legend: {
                    display: false,
                },
                tooltip: {
                  callbacks: {
                    label: (context) => {
                      // console.log(context)
                      return ` ${context.label} - ${context.raw} ${context_label}`
                    }
                  }
                }
            },
            layout: {
                padding: {
                    left: 5,
                    right: 5,
                    top: 5,
                    bottom: 5
                }
            },
            aspectRatio: 1,
            maintainAspectRatio: false
        },
    };


    if(myChart_bar_outcomes!= null) {
      myChart_bar_outcomes.destroy()
    }

    myChart_bar_outcomes = new Chart(canvas, config);

}
  

    $.get(`/finances/get_income_or_outcome_by_type?get_what=outcome&summary_type=year1&view_type=amount`, function (res) {
        doughnut_chart_outcomes(res, 'outcome_by_type', res.context_label);
      });

    $.get(`/finances/get_income_or_outcome_by_type?get_what=income&summary_type=year1&view_type=amount`, function (res) {
        doughnut_chart_incomes(res, 'income_by_type', res.context_label);
      });

    $.get(`/finances/get_income_or_outcome_bar_chart?get_what=income&summary_type=year1`, function (res) {
        bar_chart_incomes(res, 'income_bar_chart', res.context_label);
      });

    $.get(`/finances/get_income_or_outcome_bar_chart?get_what=outcome&summary_type=year1`, function (res) {
      bar_chart_outcomes(res, 'outcome_bar_chart', res.context_label);
    });



  
      $('#chart-time-type-outcome').on('change', function() {
        let summary_type = $('#chart-time-type-outcome').val()
        let view_type = $('#chart-view-type-outcome').val()
        $.get(`/finances/get_income_or_outcome_by_type?get_what=outcome&summary_type=${summary_type}&view_type=${view_type}`, function (res) {
        doughnut_chart_outcomes(res, 'outcome_by_type', res.context_label);
      });
    })

    $('#chart-view-type-outcome').on('change', function() {
        let summary_type = $('#chart-time-type-outcome').val()
        let view_type = $('#chart-view-type-outcome').val()
        $.get(`/finances/get_income_or_outcome_by_type?get_what=outcome&summary_type=${summary_type}&view_type=${view_type}`, function (res) {
        doughnut_chart_outcomes(res, 'outcome_by_type', res.context_label);
      });
    })

    $('#chart-time-type-income').on('change', function() {
        let summary_type = $('#chart-time-type-income').val()
        let view_type = $('#chart-view-type-income').val()
        $.get(`/finances/get_income_or_outcome_by_type?get_what=income&summary_type=${summary_type}&view_type=${view_type}`, function (res) {
        doughnut_chart_incomes(res, 'income_by_type', res.context_label);
      });
    })

    $('#chart-view-type-income').on('change', function() {
        let summary_type = $('#chart-time-type-income').val()
        let view_type = $('#chart-view-type-income').val()
        $.get(`/finances/get_income_or_outcome_by_type?get_what=income&summary_type=${summary_type}&view_type=${view_type}`, function (res) {
        doughnut_chart_incomes(res, 'income_by_type', res.context_label);
      });
    })

    $('#bar-chart-time-type-outcome').on('change', function() {
        let summary_type = $('#bar-chart-time-type-outcome').val()
        $.get(`/finances/get_income_or_outcome_bar_chart?get_what=outcome&summary_type=${summary_type}`, function (res) {
          bar_chart_outcomes(res, 'outcome_bar_chart', res.context_label);
      });
    })

    $('#bar-chart-time-type-income').on('change', function() {
        let summary_type = $('#bar-chart-time-type-income').val()
        $.get(`/finances/get_income_or_outcome_bar_chart?get_what=income&summary_type=${summary_type}`, function (res) {
          bar_chart_incomes(res, 'income_bar_chart', res.context_label);
      });
    })
  

    // $('#chart-time-type-outcome').on('change', function() {
    //     let summary_type = $('#chart-time-type-outcome').val()
    //     $.get(`/finances/get_income_or_outcome_by_type?get_what=income&summary_type=${summary_type}`, function (res) {
    //     doughnut_chart(res, 'outcome_by_type')
    //   })
    
    // })
  
    
  
  //   let myChart = document.getElementById('myChart').getContext('2d');
  
  // let massPopChart = new Chart(myChart, {
  //     type: 'line',
  //     data:{
  //         labels: [{% for item in label %}'{{ item | date:"d/m/y" }}',{% endfor %}],
  //         datasets:[
  //           {
  //             label: 'Cel',
  //             data:[{% for item in label %} 8,{% endfor %}],
  //             // backgroundColor: 'rgba(54, 185, 204, 0.5)'
  //             fill: false
  //           },
  //           {
  //             label: 'IloÅ›Ä‡ godzin snu',
  //             data:[{% for item in data %}{{item}},{% endfor %}],
  //             backgroundColor: 'rgba(54, 185, 204, 0.5)'
  //           }
  //         ]
  //     },
  //     options: {
  //       scales: {
  //         xAxes: [{
  //           display: true
  //         }],
  //         yAxes: [{
  //           display: true,
  //           ticks: {
  //             suggestedMin: 20,
  //             suggestedMax: 100,
  //             stepSize: 1
  //           }
  //         }]
  //       }
  //     }
  // })
  // })
})
  
  </script>


{% endblock %}